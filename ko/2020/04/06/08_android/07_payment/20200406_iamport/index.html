
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Yologger&#39;s Blog">
    <title>[결제(Payment)] (6) PG결제 구현하기(아임포트) - Yologger&#39;s Blog</title>
    <meta name="author" content="yologger">
    
    
        <link rel="icon" href="https://yologger.github.io/ko/assets/images/favicon.png">
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"yologger","sameAs":[]},"articleBody":"\n들어가며여섯 개의 포스트에 걸쳐서 안드로이드 앱의 결제 방식에 대해 알아보고있습니다.\n\n개요\n인앱 결제(Google Play Billing API) - 소모품\n인앱 결제(Google Play Billing API) - 비소모품\n인앱 결제(Google Play Billing API) - 정기 결제(구독)\nVAN, PG, 간편 결제의 차이점\nPG 결제 구현하기(아임포트)\n\n\nPG 연동 서비스PG 연동 서비스를 사용하면 안드로이드에서 PG 결제를 쉽게 구현할 수 있습니다. PG 연동 서비스는 결제 모듈, 결제 API 서비스 등으로도 불립니다. 국내에서 PG 연동 서비스를 제공하는 회사에는 아임포트, 부트페이 등이 있습니다.\n아임포트나 부트페이는 PG 연동 서비스 외에도 비즈니스에 도움이 되는 통계분석 정보, 관리자 페이지 등을 제공합니다.\n이번 포스트에서는 아임포트의 PG 연동 서비스를 사용하여 PG결제를 구현해보겠습니다.\n(1) PG사 선택 및 가입가맹점은 PG사에 가입해야합니다. 다만 아임포트나 부트페이는 PG사 가입을 대행해줍니다. PG사별로 수수료, 고객지원 서비스 등을 참고하여 PG사를 선택합니다.  \n(2) 아임포트 회원가입 및 PG 가입아임포트에 접속하여 회원가입을 합니다.\n로그인 후 지금 시작하기 버튼을 선택합니다.\nPG 가입신청서를 작성합니다.\n(3) 가맹점 식별코드, REST API키, REST API secretPG 가입신청이 완료되면 가맹점 식별코드, REST API키, REST API secret이 발급됩니다. \n아임포트 홈페이지에서 관리자 콘솔로 이동합니다.\n시스템 설정탭에서 가맹점 식별코드, REST API키, REST API secret을 확인할 수 있습니다.\n(4) 의존성 추가안드로이드 스튜디오 프로젝트를 생성하고 의존성을 추가합니다.\n프로젝트 수준의 build.gradlegroovy12345678allprojects {    repositories {        // ...        maven {            url 'https://jitpack.io'        }    }}\n\n모듈 수준의 build.gradlegroovy123456789101112android {    ..    buildFeatures {            viewBinding true            dataBinding true    }}dependencies {    // iamport    implementation \"com.github.iamport:iamport-android:$iamport_version\"}\n\n(5) 아임포트 초기화Application 클래스를 정의하고 아임포트를 다음과 같이 초기화합니다.\nApp.ktkotlin12345678class App: Application() {    override fun onCreate() {        super.onCreate()        // 아임포트 초기화        Iamport.create(this)    }}\n\nAndroidManifest.xml에 어플리케이션 클래스를 추가합니다.\nAndroidManifest.xmlxml1234567&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;manifest .. &gt;    &lt;application        android:name=\".App\"        ..&gt;    &lt;/application&gt;&lt;/manifest&gt;\n\n(6) 레이아웃 구성다음과 같은 앱을 만들어보겠습니다.\n레이아웃은 다음과 같습니다.\nactivity_main.xmlxml12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"    xmlns:app=\"http://schemas.android.com/apk/res-auto\"    xmlns:tools=\"http://schemas.android.com/tools\"    android:layout_width=\"match_parent\"    android:layout_height=\"match_parent\"    android:orientation=\"vertical\"    tools:context=\".MainActivity\"&gt;    &lt;ImageView        android:id=\"@+id/activity_main_imageView\"        android:layout_width=\"match_parent\"        android:layout_height=\"wrap_content\"        app:srcCompat=\"@drawable/galaxy\"        android:adjustViewBounds=\"true\"        /&gt;    &lt;androidx.constraintlayout.widget.ConstraintLayout        android:layout_width=\"match_parent\"        android:layout_height=\"0dp\"        android:padding=\"16dp\"        android:layout_weight=\"1\"&gt;        &lt;TextView            android:id=\"@+id/activity_main_textView_product_name\"            android:layout_width=\"match_parent\"            android:layout_height=\"wrap_content\"            app:layout_constraintTop_toTopOf=\"parent\"            app:layout_constraintStart_toStartOf=\"parent\"            app:layout_constraintEnd_toEndOf=\"parent\"            android:textSize=\"33sp\"            android:textStyle=\"bold\"            android:textColor=\"@color/black\"            android:text=\"Samsung Galaxy S21\"/&gt;        &lt;TextView            android:id=\"@+id/activity_main_textView_product_price\"            android:layout_width=\"match_parent\"            android:layout_height=\"wrap_content\"            app:layout_constraintTop_toBottomOf=\"@+id/activity_main_textView_product_name\"            app:layout_constraintStart_toStartOf=\"parent\"            android:textSize=\"25sp\"            android:text=\"$799\"/&gt;        &lt;Button            android:id=\"@+id/activity_main_button_buy\"            android:layout_width=\"match_parent\"            android:layout_height=\"wrap_content\"            app:layout_constraintStart_toStartOf=\"parent\"            app:layout_constraintEnd_toEndOf=\"parent\"            app:layout_constraintBottom_toBottomOf=\"parent\"            android:text=\"Buy\"/&gt;    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;&lt;/LinearLayout&gt;\n\n\nMainActivity.ktkotlin123456789101112131415class MainActivity : AppCompatActivity() {    private val buttonBuy: Button by lazy { findViewById&lt;Button&gt;(R.id.activity_main_button_buy)}    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_main)    }    private fun setupUI() {        buttonBuy.setOnClickListener {            // 결제 시작        }    }}\n\n(7) 결제 구현하기우선 onCreate()에서 아임포트 모듈을 초기화합니다.\nMainActivity.ktkotlin1234567891011121314151617class MainActivity : AppCompatActivity() {    private val buttonBuy: Button by lazy { findViewById&lt;Button&gt;(R.id.activity_main_button_buy)}    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_main)        // 아임포트 모듈 초기화        Iamport.init(this)     }    private fun setupUI() {        buttonBuy.setOnClickListener {            // 결제 시작        }    }}\n\n버튼을 눌렀을 때 결제창으로 이동하는 코드는 다음과 같습니다.\nMainActivity.ktkotlin1234567891011121314151617181920212223242526272829303132333435363738class MainActivity : AppCompatActivity() {    private val buttonBuy: Button by lazy { findViewById&lt;Button&gt;(R.id.activity_main_button_buy)}    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_main)        // 아임포트 모듈 초기화        Iamport.init(this)     }    private fun setupUI() {        buttonBuy.setOnClickListener {            pay()        }    }    private fun pay() {        val request = IamPortRequest(            pg = PG.html5_inicis.makePgRawName(\"\"),     // PG사            pay_method = PayMethod.card,                // 신용카드            name = \"Test Order\",                        // 주문명            merchant_uid = \"sample_aos_${Date().time}\", // 주문 번호            amount = \"1000\",                            // 결제 금액            buyer_name = \"yologger\"                     // 주문자 이름        )        val userCode = \"iamport\"    // 가맹점 코드        Iamport.payment(            userCode = userCode,             iamPortRequest = request,             paymentResultCallback = { response: IamPortResponse? -&gt;            // 결제 완료 시.        })     }}\n우선 결제 요청을 생성하기 위해 IamPortRequest의 인스턴스를 생성합니다. IamPortRequest의 인스턴스를 생성할 때 사용할 PG사, 결제 방법, 주문명 등의 정보를 전달합니다.\n12345678val request = IamPortRequest(    pg = PG.html5_inicis.makePgRawName(&quot;&quot;),     // PG사, 이니시스    pay_method = PayMethod.card,                // 신용카드    name = &quot;Test Order&quot;,                        // 주문명    merchant_uid = &quot;sample_aos_$&#123;Date().time&#125;&quot;, // 주문 번호    amount = &quot;1000&quot;,                            // 결제 금액    buyer_name = &quot;yologger&quot;                     // 주문자 이름)\n\nIamport클래스의 payment()를 호출하면 결제 페이지로 이동하게됩니다. \n123456789101112131415Iamport.payment(    userCode = userCode,     iamPortRequest = request,    paymentResultCallback = &#123; response: IamPortResponse? -&gt;    // 결제 완료 시    if (response != null) &#123;        if (response!!.success) &#123;            // 결제 성공        &#125; else &#123;            // 결제 실패        &#125;    &#125; else &#123;        // 결제 실패    &#125;&#125;)\n첫 번째 인자인 userCode는 아임포트 홈페이지에서 발급받은 가맹점 코드입니다. 문자열 “iamport”을 전달하면 테스트 결제가 이루어집니다.\n두 번째 인자로는 IamPortRequest의 인스턴스를 전달합니다.\n세 번째 인자로는 결제 완료 시 호출될 콜백함수를 전달합니다. 이 콜백 함수는 IamPortResponse의 인스턴스를 인자로 전달받는데 이 값을 확인하여 결제 성공, 결제 실패, 사용자 취소 등을 확인할 수 있습니다.\n이제 앱을 실행하고 Buy버튼을 클릭하면 결제가 이루어집니다.\n(8) 결제 데이터 검증보통 클라이언트에서 결제가 성공하면 결제 데이터를 백엔드 서버에 전송합니다. 백엔드 서버는 결제 데이터가 올바른지 검증해야합니다.아래 사진에서 안드로이드 개발자가 고려해야할 부분은 파란색 입니다. 남은 부분은 백엔드 서버 개발자가 구현합니다.서버 검증을 요청하는 코드는 대략 다음과 같습니다.\n123456789101112131415161718192021Iamport.payment(userCode = userCode, iamPortRequest = request) &#123; response: IamPortResponse? -&gt;    // 결제 완료 시    if (response != null) &#123;        if (response!!.success) &#123;            // 결제 성공 시            serverApi.requestVerification(response) &#123; result -&gt;                if (result.isSuccess) &#123;                    // 검증 성공 시 결제 완료창으로 이동                    showPaymentCompletionWindow()                &#125; else &#123;                    // 검증 실패 시 에러 메시지                    showErrorMessage()                &#125;            &#125;        &#125; else &#123;            // 결제 실패        &#125;    &#125; else &#123;        // 결제 실패    &#125;&#125;\n\n","dateCreated":"2020-04-06T00:00:00+09:00","dateModified":"2021-12-16T17:08:52+09:00","datePublished":"2020-04-06T00:00:00+09:00","description":"","headline":"[결제(Payment)] (6) PG결제 구현하기(아임포트)","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"},"publisher":{"@type":"Organization","name":"yologger","sameAs":[]},"url":"https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/","keywords":"Android, Payment"}</script>
    <meta name="description" content="들어가며여섯 개의 포스트에 걸쳐서 안드로이드 앱의 결제 방식에 대해 알아보고있습니다.  개요 인앱 결제(Google Play Billing API) - 소모품 인앱 결제(Google Play Billing API) - 비소모품 인앱 결제(Google Play Billing API) - 정기 결제(구독) VAN, PG, 간편 결제의 차이점 PG 결제 구현하">
<meta property="og:type" content="blog">
<meta property="og:title" content="[결제(Payment)] (6) PG결제 구현하기(아임포트)">
<meta property="og:url" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/index.html">
<meta property="og:site_name" content="Yologger&#39;s Blog">
<meta property="og:description" content="들어가며여섯 개의 포스트에 걸쳐서 안드로이드 앱의 결제 방식에 대해 알아보고있습니다.  개요 인앱 결제(Google Play Billing API) - 소모품 인앱 결제(Google Play Billing API) - 비소모품 인앱 결제(Google Play Billing API) - 정기 결제(구독) VAN, PG, 간편 결제의 차이점 PG 결제 구현하">
<meta property="og:locale" content="ko_KR">
<meta property="og:image" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/1.png">
<meta property="og:image" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/2.png">
<meta property="og:image" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/3.png">
<meta property="og:image" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/4.png">
<meta property="og:image" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/5.png">
<meta property="og:image" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/6.gif">
<meta property="og:image" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/7.png">
<meta property="og:image" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/8.png">
<meta property="article:published_time" content="2020-04-05T15:00:00.000Z">
<meta property="article:modified_time" content="2021-12-16T08:08:52.347Z">
<meta property="article:author" content="yologger">
<meta property="article:tag" content="Android">
<meta property="article:tag" content="Payment">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/1.png">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/ko/assets/css/style-mg0ufdhe3lf13uaqzh5sfd3dtbhx3iokplil152c5hqau8lqr315qgpxsjvw.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QYKNWR810R"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-QYKNWR810R');
    </script>


    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/ko/"
            aria-label=""
        >
            Yologger&#39;s Blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="링크 열기: /ko/#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://yologger.github.io"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="English"
                        >
                        <i class="sidebar-button-icon fa fa-globe" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">English</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/yologger"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/mailto"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/java"
                            
                            rel="noopener"
                            title="Java"
                        >
                        <i class="sidebar-button-icon fab fa-java" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Java</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/kotlin"
                            
                            rel="noopener"
                            title="Kotlin"
                        >
                        <i class="sidebar-button-icon fab fa-korvue" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Kotlin</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/spring"
                            
                            rel="noopener"
                            title="Spring"
                        >
                        <i class="sidebar-button-icon fas fa-leaf" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Spring</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/android"
                            
                            rel="noopener"
                            title="Android"
                        >
                        <i class="sidebar-button-icon fab fa-android" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Android</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/infra_devops"
                            
                            rel="noopener"
                            title="Infra, DevOps"
                        >
                        <i class="sidebar-button-icon fa fa-server" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Infra, DevOps</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/tools"
                            
                            rel="noopener"
                            title="Tool"
                        >
                        <i class="sidebar-button-icon fa fa-wrench" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tool</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/algorithm"
                            
                            rel="noopener"
                            title="Algorithm"
                        >
                        <i class="sidebar-button-icon fas fa-project-diagram" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Algorithm</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            [결제(Payment)] (6) PG결제 구현하기(아임포트)
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-04-06T00:00:00+09:00">
	
		    2020/04/06
    	
    </time>
    
        <span>카테고리 </span>
        
    <a class="category-link" href="/ko/categories/Android/">Android</a>, <a class="category-link" href="/ko/categories/Android/Payment/">Payment</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <hr>
<h1 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h1><p>여섯 개의 포스트에 걸쳐서 안드로이드 앱의 결제 방식에 대해 알아보고있습니다.</p>
<ol>
<li><a href="/ko/2020/04/01/08_android/07_payment/20200401_payment_intro/">개요</a></li>
<li><a href="/ko/2020/04/02/08_android/07_payment/20200402_GooglePlayBilling_ConsumableProduct/">인앱 결제(Google Play Billing API) - 소모품</a></li>
<li><a href="/ko/2020/04/03/08_android/07_payment/20200403_GooglePlayBilling_NonConsumableProduct/">인앱 결제(Google Play Billing API) - 비소모품</a></li>
<li><a href="/ko/2020/04/04/08_android/07_payment/20200404_GooglePlayBilling_Subscription/">인앱 결제(Google Play Billing API) - 정기 결제(구독)</a></li>
<li><a href="/ko/2020/04/05/08_android/07_payment/20200405_pg/">VAN, PG, 간편 결제의 차이점</a></li>
<li><a href="/ko/2020/04/06/08_android/07_payment/20200406_iamport/">PG 결제 구현하기(아임포트)</a></li>
</ol>
<hr>
<h1 id="PG-연동-서비스"><a href="#PG-연동-서비스" class="headerlink" title="PG 연동 서비스"></a>PG 연동 서비스</h1><p><code>PG 연동 서비스</code>를 사용하면 안드로이드에서 PG 결제를 쉽게 구현할 수 있습니다. <code>PG 연동 서비스</code>는 <code>결제 모듈</code>, <code>결제 API 서비스</code> 등으로도 불립니다. 국내에서 <code>PG 연동 서비스</code>를 제공하는 회사에는 <a target="_blank" rel="noopener" href="https://www.iamport.kr/"><code>아임포트</code></a>, <a target="_blank" rel="noopener" href="https://www.bootpay.co.kr/"><code>부트페이</code></a> 등이 있습니다.</p>
<p>아임포트나 부트페이는 <code>PG 연동 서비스</code> 외에도 비즈니스에 도움이 되는 <code>통계분석 정보</code>, <code>관리자 페이지</code> 등을 제공합니다.</p>
<p>이번 포스트에서는 아임포트의 <code>PG 연동 서비스</code>를 사용하여 PG결제를 구현해보겠습니다.</p>
<h1 id="1-PG사-선택-및-가입"><a href="#1-PG사-선택-및-가입" class="headerlink" title="(1) PG사 선택 및 가입"></a>(1) PG사 선택 및 가입</h1><p>가맹점은 PG사에 가입해야합니다. 다만 아임포트나 부트페이는 PG사 가입을 대행해줍니다. PG사별로 수수료, 고객지원 서비스 등을 참고하여 PG사를 선택합니다.  </p>
<h1 id="2-아임포트-회원가입-및-PG-가입"><a href="#2-아임포트-회원가입-및-PG-가입" class="headerlink" title="(2) 아임포트 회원가입 및 PG 가입"></a>(2) 아임포트 회원가입 및 PG 가입</h1><p><a target="_blank" rel="noopener" href="https://www.iamport.kr/">아임포트</a>에 접속하여 회원가입을 합니다.<br><img src="1.png"></p>
<p>로그인 후 <code>지금 시작하기</code> 버튼을 선택합니다.<br><img src="2.png"></p>
<p>PG 가입신청서를 작성합니다.<br><img src="3.png"></p>
<h1 id="3-가맹점-식별코드-REST-API키-REST-API-secret"><a href="#3-가맹점-식별코드-REST-API키-REST-API-secret" class="headerlink" title="(3) 가맹점 식별코드, REST API키, REST API secret"></a>(3) 가맹점 식별코드, REST API키, REST API secret</h1><p>PG 가입신청이 완료되면 <code>가맹점 식별코드</code>, <code>REST API키</code>, <code>REST API secret</code>이 발급됩니다. </p>
<p>아임포트 홈페이지에서 <code>관리자 콘솔</code>로 이동합니다.<br><img src="4.png"></p>
<p><code>시스템 설정</code>탭에서 <code>가맹점 식별코드</code>, <code>REST API키</code>, <code>REST API secret</code>을 확인할 수 있습니다.<br><img src="5.png"></p>
<h1 id="4-의존성-추가"><a href="#4-의존성-추가" class="headerlink" title="(4) 의존성 추가"></a>(4) 의존성 추가</h1><p>안드로이드 스튜디오 프로젝트를 생성하고 의존성을 추가합니다.</p>
<figure class="codeblock codeblock--tabbed"><figcaption><span>프로젝트 수준의 build.gradle</span><ul class="tabs"><li class="tab active">groovy</li></ul></figcaption><div class="tabs-content"><figure class="highlight groovy" style="display: block;"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">allprojects {</span><br><span class="line">    repositories {</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        maven {</span><br><span class="line">            url <span class="string">'https://jitpack.io'</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure>

<figure class="codeblock codeblock--tabbed"><figcaption><span>모듈 수준의 build.gradle</span><ul class="tabs"><li class="tab active">groovy</li></ul></figcaption><div class="tabs-content"><figure class="highlight groovy" style="display: block;"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">android {</span><br><span class="line">    ..</span><br><span class="line">    buildFeatures {</span><br><span class="line">            viewBinding <span class="literal">true</span></span><br><span class="line">            dataBinding <span class="literal">true</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">dependencies {</span><br><span class="line">    <span class="comment">// iamport</span></span><br><span class="line">    implementation <span class="string">"com.github.iamport:iamport-android:$iamport_version"</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure>

<h1 id="5-아임포트-초기화"><a href="#5-아임포트-초기화" class="headerlink" title="(5) 아임포트 초기화"></a>(5) 아임포트 초기화</h1><p><code>Application</code> 클래스를 정의하고 아임포트를 다음과 같이 초기화합니다.</p>
<figure class="codeblock codeblock--tabbed"><figcaption><span>App.kt</span><ul class="tabs"><li class="tab active">kotlin</li></ul></figcaption><div class="tabs-content"><figure class="highlight kotlin" style="display: block;"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span>: <span class="type">Application</span></span>() {</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">()</span></span> {</span><br><span class="line">        <span class="keyword">super</span>.onCreate()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 아임포트 초기화</span></span><br><span class="line">        Iamport.create(<span class="keyword">this</span>)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure>

<p><code>AndroidManifest.xml</code>에 어플리케이션 클래스를 추가합니다.</p>
<figure class="codeblock codeblock--tabbed"><figcaption><span>AndroidManifest.xml</span><ul class="tabs"><li class="tab active">xml</li></ul></figcaption><div class="tabs-content"><figure class="highlight xml" style="display: block;"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">..</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">".App"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">..</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></div></figure>

<h1 id="6-레이아웃-구성"><a href="#6-레이아웃-구성" class="headerlink" title="(6) 레이아웃 구성"></a>(6) 레이아웃 구성</h1><p>다음과 같은 앱을 만들어보겠습니다.<br><img src="6.gif"></p>
<p>레이아웃은 다음과 같습니다.</p>
<figure class="codeblock codeblock--tabbed"><figcaption><span>activity_main.xml</span><ul class="tabs"><li class="tab active">xml</li></ul></figcaption><div class="tabs-content"><figure class="highlight xml" style="display: block;"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/activity_main_imageView"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:srcCompat</span>=<span class="string">"@drawable/galaxy"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:adjustViewBounds</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"0dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:padding</span>=<span class="string">"16dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/activity_main_textView_product_name"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">"33sp"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textStyle</span>=<span class="string">"bold"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">"@color/black"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">"Samsung Galaxy S21"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/activity_main_textView_product_price"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">"@+id/activity_main_textView_product_name"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">"25sp"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">"$799"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/activity_main_button_buy"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">"Buy"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></div></figure>


<figure class="codeblock codeblock--tabbed"><figcaption><span>MainActivity.kt</span><ul class="tabs"><li class="tab active">kotlin</li></ul></figcaption><div class="tabs-content"><figure class="highlight kotlin" style="display: block;"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> buttonBuy: Button <span class="keyword">by</span> lazy { findViewById&lt;Button&gt;(R.id.activity_main_button_buy)}</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> {</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">setupUI</span><span class="params">()</span></span> {</span><br><span class="line">        buttonBuy.setOnClickListener {</span><br><span class="line">            <span class="comment">// 결제 시작</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure>

<h1 id="7-결제-구현하기"><a href="#7-결제-구현하기" class="headerlink" title="(7) 결제 구현하기"></a>(7) 결제 구현하기</h1><p>우선 <code>onCreate()</code>에서 아임포트 모듈을 초기화합니다.</p>
<figure class="codeblock codeblock--tabbed"><figcaption><span>MainActivity.kt</span><ul class="tabs"><li class="tab active">kotlin</li></ul></figcaption><div class="tabs-content"><figure class="highlight kotlin" style="display: block;"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> buttonBuy: Button <span class="keyword">by</span> lazy { findViewById&lt;Button&gt;(R.id.activity_main_button_buy)}</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> {</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        <span class="comment">// 아임포트 모듈 초기화</span></span><br><span class="line">        Iamport.<span class="keyword">init</span>(<span class="keyword">this</span>) </span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">setupUI</span><span class="params">()</span></span> {</span><br><span class="line">        buttonBuy.setOnClickListener {</span><br><span class="line">            <span class="comment">// 결제 시작</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure>

<p>버튼을 눌렀을 때 결제창으로 이동하는 코드는 다음과 같습니다.</p>
<figure class="codeblock codeblock--tabbed"><figcaption><span>MainActivity.kt</span><ul class="tabs"><li class="tab active">kotlin</li></ul></figcaption><div class="tabs-content"><figure class="highlight kotlin" style="display: block;"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> buttonBuy: Button <span class="keyword">by</span> lazy { findViewById&lt;Button&gt;(R.id.activity_main_button_buy)}</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> {</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        <span class="comment">// 아임포트 모듈 초기화</span></span><br><span class="line">        Iamport.<span class="keyword">init</span>(<span class="keyword">this</span>) </span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">setupUI</span><span class="params">()</span></span> {</span><br><span class="line">        buttonBuy.setOnClickListener {</span><br><span class="line">            pay()</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">pay</span><span class="params">()</span></span> {</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> request = IamPortRequest(</span><br><span class="line">            pg = PG.html5_inicis.makePgRawName(<span class="string">""</span>),     <span class="comment">// PG사</span></span><br><span class="line">            pay_method = PayMethod.card,                <span class="comment">// 신용카드</span></span><br><span class="line">            name = <span class="string">"Test Order"</span>,                        <span class="comment">// 주문명</span></span><br><span class="line">            merchant_uid = <span class="string">"sample_aos_<span class="subst">${Date().time}</span>"</span>, <span class="comment">// 주문 번호</span></span><br><span class="line">            amount = <span class="string">"1000"</span>,                            <span class="comment">// 결제 금액</span></span><br><span class="line">            buyer_name = <span class="string">"yologger"</span>                     <span class="comment">// 주문자 이름</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> userCode = <span class="string">"iamport"</span>    <span class="comment">// 가맹점 코드</span></span><br><span class="line"></span><br><span class="line">        Iamport.payment(</span><br><span class="line">            userCode = userCode, </span><br><span class="line">            iamPortRequest = request, </span><br><span class="line">            paymentResultCallback = { response: IamPortResponse? -&gt;</span><br><span class="line">            <span class="comment">// 결제 완료 시.</span></span><br><span class="line">        }) </span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div></figure>
<p>우선 결제 요청을 생성하기 위해 <code>IamPortRequest</code>의 인스턴스를 생성합니다. <code>IamPortRequest</code>의 인스턴스를 생성할 때 사용할 PG사, 결제 방법, 주문명 등의 정보를 전달합니다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> request = IamPortRequest(</span><br><span class="line">    pg = PG.html5_inicis.makePgRawName(<span class="string">&quot;&quot;</span>),     <span class="comment">// PG사, 이니시스</span></span><br><span class="line">    pay_method = PayMethod.card,                <span class="comment">// 신용카드</span></span><br><span class="line">    name = <span class="string">&quot;Test Order&quot;</span>,                        <span class="comment">// 주문명</span></span><br><span class="line">    merchant_uid = <span class="string">&quot;sample_aos_<span class="subst">$&#123;Date().time&#125;</span>&quot;</span>, <span class="comment">// 주문 번호</span></span><br><span class="line">    amount = <span class="string">&quot;1000&quot;</span>,                            <span class="comment">// 결제 금액</span></span><br><span class="line">    buyer_name = <span class="string">&quot;yologger&quot;</span>                     <span class="comment">// 주문자 이름</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><code>Iamport</code>클래스의 <code>payment()</code>를 호출하면 결제 페이지로 이동하게됩니다. </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Iamport.payment(</span><br><span class="line">    userCode = userCode, </span><br><span class="line">    iamPortRequest = request,</span><br><span class="line">    paymentResultCallback = &#123; response: IamPortResponse? -&gt;</span><br><span class="line">    <span class="comment">// 결제 완료 시</span></span><br><span class="line">    <span class="keyword">if</span> (response != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (response!!.success) &#123;</span><br><span class="line">            <span class="comment">// 결제 성공</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 결제 실패</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 결제 실패</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>첫 번째 인자인 <code>userCode</code>는 아임포트 홈페이지에서 발급받은 가맹점 코드입니다. 문자열 “iamport”을 전달하면 테스트 결제가 이루어집니다.</p>
<p>두 번째 인자로는 <code>IamPortRequest</code>의 인스턴스를 전달합니다.</p>
<p>세 번째 인자로는 결제 완료 시 호출될 콜백함수를 전달합니다. 이 콜백 함수는 <code>IamPortResponse</code>의 인스턴스를 인자로 전달받는데 이 값을 확인하여 결제 성공, 결제 실패, 사용자 취소 등을 확인할 수 있습니다.</p>
<p>이제 앱을 실행하고 <code>Buy</code>버튼을 클릭하면 결제가 이루어집니다.</p>
<h1 id="8-결제-데이터-검증"><a href="#8-결제-데이터-검증" class="headerlink" title="(8) 결제 데이터 검증"></a>(8) 결제 데이터 검증</h1><p>보통 클라이언트에서 결제가 성공하면 결제 데이터를 백엔드 서버에 전송합니다. 백엔드 서버는 결제 데이터가 올바른지 검증해야합니다.<br><img src="7.png"><br>아래 사진에서 안드로이드 개발자가 고려해야할 부분은 파란색 입니다. 남은 부분은 백엔드 서버 개발자가 구현합니다.<br><img src="8.png"><br>서버 검증을 요청하는 코드는 대략 다음과 같습니다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Iamport.payment(userCode = userCode, iamPortRequest = request) &#123; response: IamPortResponse? -&gt;</span><br><span class="line">    <span class="comment">// 결제 완료 시</span></span><br><span class="line">    <span class="keyword">if</span> (response != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (response!!.success) &#123;</span><br><span class="line">            <span class="comment">// 결제 성공 시</span></span><br><span class="line">            serverApi.requestVerification(response) &#123; result -&gt;</span><br><span class="line">                <span class="keyword">if</span> (result.isSuccess) &#123;</span><br><span class="line">                    <span class="comment">// 검증 성공 시 결제 완료창으로 이동</span></span><br><span class="line">                    showPaymentCompletionWindow()</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// 검증 실패 시 에러 메시지</span></span><br><span class="line">                    showErrorMessage()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 결제 실패</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 결제 실패</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">태그</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/ko/tags/Android/" rel="tag">Android</a> <a class="tag tag--primary tag--small t-none-link" href="/ko/tags/Payment/" rel="tag">Payment</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/ko/2020/05/01/08_android/08_google_maps/200501_GoogleMaps/"
                    data-tooltip="[구글 지도(Google Maps)] (1) 구글 지도 띄우기"
                    aria-label="이전: [구글 지도(Google Maps)] (1) 구글 지도 띄우기"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/ko/2020/04/05/08_android/07_payment/20200405_pg/"
                    data-tooltip="[결제(Payment)] (5) VAN사, PG사, 간편결제 차이점"
                    aria-label="다음: [결제(Payment)] (5) VAN사, PG사, 간편결제 차이점"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 yologger. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/ko/2020/05/01/08_android/08_google_maps/200501_GoogleMaps/"
                    data-tooltip="[구글 지도(Google Maps)] (1) 구글 지도 띄우기"
                    aria-label="이전: [구글 지도(Google Maps)] (1) 구글 지도 띄우기"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/ko/2020/04/05/08_android/07_payment/20200405_pg/"
                    data-tooltip="[결제(Payment)] (5) VAN사, PG사, 간편결제 차이점"
                    aria-label="다음: [결제(Payment)] (5) VAN사, PG사, 간편결제 차이점"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"
                        aria-label="Facebook에 공유하기"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Facebook에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"
                        aria-label="Twitter에 공유하기"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitter에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://yologger.github.io/ko/2020/04/06/08_android/07_payment/20200406_iamport/"
                        aria-label="Google+에 공유하기"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Google+에 공유하기</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">yologger</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/ko/assets/images/background.png');"></div>
        <!--SCRIPTS-->

<script src="/ko/assets/js/script-s1qf4dycbfqqmgvjljlv3c81jri2dhkbfsbrr18gdsntpulta4iextu4bozl.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
