
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Yologger&#39;s Blog">
    <title>[Android] 서비스 - (1) 스타트 서비스(Start Service) - Yologger&#39;s Blog</title>
    <meta name="author" content="yologger">
    
    
        <link rel="icon" href="https://yologger.github.io/ko/assets/images/favicon.png">
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"yologger","sameAs":[]},"articleBody":"\n서비스란?서비스(Service)는 앱에서 백그라운드 작업을 수행하기 위해 등장했습니다. 액티비티와는 다르게 서비스는 별도의 레이아웃 파일이 존재하지 않습니다. 사용자에게 음악을 스트리밍 서비스하거나 파일을 다운로드하는 것은 백그라운드에서 처리하기 적절한 작업입니다.\n서비스에는 세 가지가 있습니다.\n\nStart Service\nIntent Service\nBound Service\n\n스타트 서비스스타트 서비스(Start Service)는 다른 안드로이드 컴포넌트에 의해 시작됩니다. 그리고 서비스가 중단되거나 안드로이드 운영체제에 의해 소멸될 때까지 백그라운드에서 무한정 실행됩니다. 서비스는 자신을 시작시킨 컴포넌트가 포그라운드에 있지 않거나 소멸되어도 계속 실행됩니다. 그럼 예제를 살펴보겠습니다.\n우선 스타트 서비스는 Service클래스를 상속해야합니다.\nMyStartService.kt123456789101112131415161718class MyStartService : Service() &#123;    override fun onCreate() &#123;        super.onCreate()    &#125;    override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int &#123;        // ...    &#125;    override fun onBind(intent: Intent): IBinder? &#123;        return null    &#125;    override fun onDestroy() &#123;        super.onDestroy()    &#125;&#125;\n서비스는 액티비티와 유사하게 생명주기 함수를 가지고 있습니다. 여기서 onStartCommand()에 백그라운드에서 수행할 작업을 구현합니다. \n서비스에서 3초에 한번씩 문자열 “This is service”를 출력하겠습니다. Thread.sleep()는 현재 스레드를 특정 시간동안 중지합니다.\n12345678910111213class MyStartService : Service() &#123;    override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int &#123;        // 3초에 한 번씩 This is service. 출력        while (true) &#123;            println(&quot;This is service.&quot;)            Thread.sleep(1000 * 3)     // 3초 동안 현재 스래드 중지        &#125;        return super.onStartCommand(intent, flags, startId)    &#125;    // ...&#125;\n\nMainActivity는 두 개의 버튼이 있습니다. Start Service버튼을 누르면 서비스를 실행합니다. Show ToastMessage버튼을 누르면 토스트 메시지를 출력합니다.\n레이아웃은 다음과 같습니다.\nactivity_main.xml123456789101112131415161718192021222324252627282930&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;    android:layout_width=&quot;match_parent&quot;    android:layout_height=&quot;match_parent&quot;    tools:context=&quot;.MainActivity&quot;&gt;    &lt;Button android:id=&quot;@+id/activity_main_start_service&quot;        android:layout_width=&quot;wrap_content&quot;        android:layout_height=&quot;wrap_content&quot;        android:text=&quot;Start Service&quot;        android:textAllCaps=&quot;false&quot;        app:layout_constraintTop_toTopOf=&quot;parent&quot;        app:layout_constraintStart_toStartOf=&quot;parent&quot;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;        app:layout_constraintBottom_toTopOf=&quot;@+id/activity_main_show_toast&quot;/&gt;    &lt;Button android:id=&quot;@+id/activity_main_show_toast&quot;        android:layout_width=&quot;wrap_content&quot;        android:layout_height=&quot;wrap_content&quot;        android:text=&quot;Show Toast Message&quot;        android:textAllCaps=&quot;false&quot;        app:layout_constraintTop_toBottomOf=&quot;@+id/activity_main_start_service&quot;        app:layout_constraintStart_toStartOf=&quot;parent&quot;        app:layout_constraintEnd_toEndOf=&quot;parent&quot;        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;        /&gt;&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;\n코드는 다음과 같습니다. 스타트 서비스를 시작할 때는 startService()함수를 사용합니다.\nMainActivity.kt12345678910111213141516171819202122class MainActivity : AppCompatActivity() &#123;    lateinit var buttonShowToast: Button    lateinit var buttonStartService: Button    override fun onCreate(savedInstanceState: Bundle?) &#123;        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_main)        buttonShowToast = findViewById(R.id.activity_main_show_toast)        buttonStartService = findViewById(R.id.activity_main_start_service)        buttonStartService.setOnClickListener &#123;            var intent = Intent(this, MyStartService::class.java)            startService(serviceIntent)        &#125;        buttonShowToast.setOnClickListener &#123;            Toast.makeText(this@MainActivity, &quot;Toast Message&quot;, Toast.LENGTH_SHORT).show()        &#125;    &#125;&#125;\n이제 앱을 실행해보겠습니다. 버튼을 누르면 서비스가 백그라운드에서 실행되며, 로그에 3초에 한번씩 문자열 “This is service”가 출력됩니다.\n서비스를 호출한 컴포넌트에서 stopService()를 호출하거나, 서비스 안에서 stopSelf()를 호출하여 스타트 서비스를 정지할 수 있습니다.\n\n스타트 서비스의 문제점서비스를 실행시킨 상태에서 토스트 메시지 버튼을 눌러봅시다. 아무 응답이 없을 겁니다. 이후 다음과 같이 경고 매세지를 보여주고 앱이 종료됩니다.안드로이드에서 사용자와의 상호작용이나 UI 변경은 메인 스레드에서만 이루어집니다. 그런데 스타트 서비스도 액티비티와 같은 메인 스레드에서 실행되고 있습니다. 이 때문에 메인 스레드가 3초간 중지되어있는 동안 액티비티가 사용자와의 상호작용을 할 수 없어서 앱이 종료된 것입니다.\n위 그림처럼 다른 작업을 하느라 사용자와 상호작용할 수 없어 발생하는 에러를 ANR(Android Not Responding)이라고 합니다.\n\n\n따라서 스타트 서비스를 다른 작업 스레드에서 실행해야합니다.\n1234567891011121314151617181920class MyStartService : Service() &#123;    override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int &#123;                var runnable = Runnable &#123;            while (true) &#123;                println(&quot;This is service.&quot;)                Thread.sleep(1000 * 3)     // 10 seconds            &#125;        &#125;        // 별도의 스레드 생성        var thread = Thread(runnable)        // 스레드 시작        thread.start()        return super.onStartCommand(intent, flags, startId)    &#125;&#125;\n이제 앱이 정상적으로 작동할 것입니다.\n","dateCreated":"2019-07-01T01:00:00+09:00","dateModified":"2021-12-16T06:26:56+09:00","datePublished":"2019-07-01T01:00:00+09:00","description":"","headline":"[Android] 서비스 - (1) 스타트 서비스(Start Service)","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"},"publisher":{"@type":"Organization","name":"yologger","sameAs":[]},"url":"https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/","keywords":"Android"}</script>
    <meta name="description" content="서비스란?서비스(Service)는 앱에서 백그라운드 작업을 수행하기 위해 등장했습니다. 액티비티와는 다르게 서비스는 별도의 레이아웃 파일이 존재하지 않습니다. 사용자에게 음악을 스트리밍 서비스하거나 파일을 다운로드하는 것은 백그라운드에서 처리하기 적절한 작업입니다. 서비스에는 세 가지가 있습니다.  Start Service Intent Service Bo">
<meta property="og:type" content="blog">
<meta property="og:title" content="[Android] 서비스 - (1) 스타트 서비스(Start Service)">
<meta property="og:url" content="https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/index.html">
<meta property="og:site_name" content="Yologger&#39;s Blog">
<meta property="og:description" content="서비스란?서비스(Service)는 앱에서 백그라운드 작업을 수행하기 위해 등장했습니다. 액티비티와는 다르게 서비스는 별도의 레이아웃 파일이 존재하지 않습니다. 사용자에게 음악을 스트리밍 서비스하거나 파일을 다운로드하는 것은 백그라운드에서 처리하기 적절한 작업입니다. 서비스에는 세 가지가 있습니다.  Start Service Intent Service Bo">
<meta property="og:locale" content="ko_KR">
<meta property="og:image" content="https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/1.png">
<meta property="og:image" content="https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/2.png">
<meta property="article:published_time" content="2019-06-30T16:00:00.000Z">
<meta property="article:modified_time" content="2021-12-15T21:26:56.566Z">
<meta property="article:author" content="yologger">
<meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/1.png">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/ko/assets/css/style-mg0ufdhe3lf13uaqzh5sfd3dtbhx3iokplil152c5hqau8lqr315qgpxsjvw.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QYKNWR810R"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-QYKNWR810R');
    </script>


    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/ko/"
            aria-label=""
        >
            Yologger&#39;s Blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="링크 열기: /ko/#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://yologger.github.io"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="English"
                        >
                        <i class="sidebar-button-icon fa fa-globe" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">English</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/yologger"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/mailto"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/java"
                            
                            rel="noopener"
                            title="Java"
                        >
                        <i class="sidebar-button-icon fab fa-java" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Java</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/kotlin"
                            
                            rel="noopener"
                            title="Kotlin"
                        >
                        <i class="sidebar-button-icon fab fa-korvue" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Kotlin</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/spring"
                            
                            rel="noopener"
                            title="Spring"
                        >
                        <i class="sidebar-button-icon fas fa-leaf" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Spring</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/android"
                            
                            rel="noopener"
                            title="Android"
                        >
                        <i class="sidebar-button-icon fab fa-android" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Android</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/infra_devops"
                            
                            rel="noopener"
                            title="Infra, DevOps"
                        >
                        <i class="sidebar-button-icon fa fa-server" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Infra, DevOps</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/tools"
                            
                            rel="noopener"
                            title="Tool"
                        >
                        <i class="sidebar-button-icon fa fa-wrench" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tool</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/ko/algorithm"
                            
                            rel="noopener"
                            title="Algorithm"
                        >
                        <i class="sidebar-button-icon fas fa-project-diagram" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Algorithm</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            [Android] 서비스 - (1) 스타트 서비스(Start Service)
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-07-01T01:00:00+09:00">
	
		    2019/07/01
    	
    </time>
    
        <span>카테고리 </span>
        
    <a class="category-link" href="/ko/categories/Android/">Android</a>, <a class="category-link" href="/ko/categories/Android/Android-Platform/">Android Platform</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <hr>
<h1 id="서비스란"><a href="#서비스란" class="headerlink" title="서비스란?"></a>서비스란?</h1><p><code>서비스(Service)</code>는 앱에서 백그라운드 작업을 수행하기 위해 등장했습니다. 액티비티와는 다르게 서비스는 별도의 레이아웃 파일이 존재하지 않습니다. 사용자에게 음악을 스트리밍 서비스하거나 파일을 다운로드하는 것은 백그라운드에서 처리하기 적절한 작업입니다.</p>
<p>서비스에는 세 가지가 있습니다.</p>
<ul>
<li>Start Service</li>
<li>Intent Service</li>
<li>Bound Service</li>
</ul>
<h1 id="스타트-서비스"><a href="#스타트-서비스" class="headerlink" title="스타트 서비스"></a>스타트 서비스</h1><p><code>스타트 서비스(Start Service)</code>는 다른 안드로이드 컴포넌트에 의해 시작됩니다. 그리고 서비스가 중단되거나 안드로이드 운영체제에 의해 소멸될 때까지 백그라운드에서 무한정 실행됩니다. 서비스는 자신을 시작시킨 컴포넌트가 포그라운드에 있지 않거나 소멸되어도 계속 실행됩니다. 그럼 예제를 살펴보겠습니다.</p>
<p>우선 스타트 서비스는 <code>Service</code>클래스를 상속해야합니다.</p>
<figure class="highlight kotlin"><figcaption><span>MyStartService.kt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyStartService</span> : <span class="type">Service</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStartCommand</span><span class="params">(intent: <span class="type">Intent</span>?, flags: <span class="type">Int</span>, startId: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBind</span><span class="params">(intent: <span class="type">Intent</span>)</span></span>: IBinder? &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroy</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>서비스는 액티비티와 유사하게 <a href="/ko/2019/07/04/08_android/01_android_platform/190704_service_lifecycle/">생명주기 함수</a>를 가지고 있습니다. 여기서 <code>onStartCommand()</code>에 백그라운드에서 수행할 작업을 구현합니다. </p>
<p>서비스에서 3초에 한번씩 문자열 “This is service”를 출력하겠습니다. <code>Thread.sleep()</code>는 현재 스레드를 특정 시간동안 중지합니다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyStartService</span> : <span class="type">Service</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStartCommand</span><span class="params">(intent: <span class="type">Intent</span>?, flags: <span class="type">Int</span>, startId: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3초에 한 번씩 This is service. 출력</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            println(<span class="string">&quot;This is service.&quot;</span>)</span><br><span class="line">            Thread.sleep(<span class="number">1000</span> * <span class="number">3</span>)     <span class="comment">// 3초 동안 현재 스래드 중지</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onStartCommand(intent, flags, startId)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>MainActivity</code>는 두 개의 버튼이 있습니다. <code>Start Service</code>버튼을 누르면 서비스를 실행합니다. <code>Show ToastMessage</code>버튼을 누르면 토스트 메시지를 출력합니다.<br><img src="1.png"></p>
<p>레이아웃은 다음과 같습니다.</p>
<figure class="highlight xml"><figcaption><span>activity_main.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">android:id</span>=<span class="string">&quot;@+id/activity_main_start_service&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Start Service&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textAllCaps</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toTopOf</span>=<span class="string">&quot;@+id/activity_main_show_toast&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">android:id</span>=<span class="string">&quot;@+id/activity_main_show_toast&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Show Toast Message&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textAllCaps</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/activity_main_start_service&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>코드는 다음과 같습니다. 스타트 서비스를 시작할 때는 <code>startService()</code>함수를 사용합니다.</p>
<figure class="highlight kotlin"><figcaption><span>MainActivity.kt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">lateinit</span> <span class="keyword">var</span> buttonShowToast: Button</span><br><span class="line">    <span class="keyword">lateinit</span> <span class="keyword">var</span> buttonStartService: Button</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        buttonShowToast = findViewById(R.id.activity_main_show_toast)</span><br><span class="line">        buttonStartService = findViewById(R.id.activity_main_start_service)</span><br><span class="line"></span><br><span class="line">        buttonStartService.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">var</span> intent = Intent(<span class="keyword">this</span>, MyStartService::<span class="keyword">class</span>.java)</span><br><span class="line">            startService(serviceIntent)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        buttonShowToast.setOnClickListener &#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span><span class="symbol">@MainActivity</span>, <span class="string">&quot;Toast Message&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이제 앱을 실행해보겠습니다. 버튼을 누르면 서비스가 백그라운드에서 실행되며, 로그에 3초에 한번씩 문자열 “This is service”가 출력됩니다.</p>
<p>서비스를 호출한 컴포넌트에서 <code>stopService()</code>를 호출하거나, 서비스 안에서 <code>stopSelf()</code>를 호출하여 스타트 서비스를 정지할 수 있습니다.</p>
<hr>
<h1 id="스타트-서비스의-문제점"><a href="#스타트-서비스의-문제점" class="headerlink" title="스타트 서비스의 문제점"></a>스타트 서비스의 문제점</h1><p>서비스를 실행시킨 상태에서 토스트 메시지 버튼을 눌러봅시다. 아무 응답이 없을 겁니다. 이후 다음과 같이 경고 매세지를 보여주고 앱이 종료됩니다.<br><img src="2.png"><br>안드로이드에서 사용자와의 상호작용이나 UI 변경은 <code>메인 스레드</code>에서만 이루어집니다. 그런데 스타트 서비스도 액티비티와 같은 메인 스레드에서 실행되고 있습니다. 이 때문에 메인 스레드가 3초간 중지되어있는 동안 액티비티가 사용자와의 상호작용을 할 수 없어서 앱이 종료된 것입니다.</p>
<div class="alert info"><p>위 그림처럼 다른 작업을 하느라 사용자와 상호작용할 수 없어 발생하는 에러를 <b>ANR(Android Not Responding)</b>이라고 합니다.</p>
</div>

<p>따라서 스타트 서비스를 다른 작업 스레드에서 실행해야합니다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyStartService</span> : <span class="type">Service</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStartCommand</span><span class="params">(intent: <span class="type">Intent</span>?, flags: <span class="type">Int</span>, startId: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> runnable = Runnable &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                println(<span class="string">&quot;This is service.&quot;</span>)</span><br><span class="line">                Thread.sleep(<span class="number">1000</span> * <span class="number">3</span>)     <span class="comment">// 10 seconds</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 별도의 스레드 생성</span></span><br><span class="line">        <span class="keyword">var</span> thread = Thread(runnable)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 스레드 시작</span></span><br><span class="line">        thread.start()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onStartCommand(intent, flags, startId)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이제 앱이 정상적으로 작동할 것입니다.</p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">태그</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/ko/tags/Android/" rel="tag">Android</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/ko/2019/07/02/08_android/01_android_platform/190702_intent_service/"
                    data-tooltip="[Android] 서비스 - (2) 인텐트 서비스(Intent Service)"
                    aria-label="이전: [Android] 서비스 - (2) 인텐트 서비스(Intent Service)"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/ko/2019/06/27/08_android/01_android_platform/190627_async_nonblocking/"
                    data-tooltip="[Android] 비동기, 논블로킹, runOnUiThread()"
                    aria-label="다음: [Android] 비동기, 논블로킹, runOnUiThread()"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 yologger. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/ko/2019/07/02/08_android/01_android_platform/190702_intent_service/"
                    data-tooltip="[Android] 서비스 - (2) 인텐트 서비스(Intent Service)"
                    aria-label="이전: [Android] 서비스 - (2) 인텐트 서비스(Intent Service)"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/ko/2019/06/27/08_android/01_android_platform/190627_async_nonblocking/"
                    data-tooltip="[Android] 비동기, 논블로킹, runOnUiThread()"
                    aria-label="다음: [Android] 비동기, 논블로킹, runOnUiThread()"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"
                        aria-label="Facebook에 공유하기"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Facebook에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"
                        aria-label="Twitter에 공유하기"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitter에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://yologger.github.io/ko/2019/07/01/08_android/01_android_platform/190701_start_service/"
                        aria-label="Google+에 공유하기"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Google+에 공유하기</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">yologger</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/ko/assets/images/background.png');"></div>
        <!--SCRIPTS-->

<script src="/ko/assets/js/script-s1qf4dycbfqqmgvjljlv3c81jri2dhkbfsbrr18gdsntpulta4iextu4bozl.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
